Here we show a statemachine with pvbrowser.
See: rllib reference class rlState detailed description.

Under statemachine/plc you find the statemachine consisting of several threads.
The main thread will read/write a Modbus PLC.
The statemachine stm2 will handle a small demo statemachine.
The statemachine stm1 will start stm2 if the user selects this function.

The data will be stored in a shared memory.
The shared memory contains a complex datastructure (typedef struct {...} USER_DEFINED_STRUCTURE;) which can be used to exchange values between several processes.

The pvbrowser visualization server is located under statemachine/pvs
There we use a SVG graphic (stm2.svg) showing the statemachine.
This graphic is generated by graphviz from stm2.dot
pvs and plc exchange data only via shared memory.

Please start both (plc and pvs) in a separate terminal and then start the pvbrowser client.

###########################################
Here you find howto do statemachines in Lua.

http://www.lua.org/pil/6.3.html
